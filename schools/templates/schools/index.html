{% extends './_base.html' %}
{% load static i18n %}

{% block title %}
    {{ title }}
{% endblock title %}
    

{% block styles %}
<style>
    .carousel-wrapper {
        scrollbar-width: none;  
        -ms-overflow-style: none;  
    }
    
    .carousel-wrapper::-webkit-scrollbar {
        display: none;  
    }
</style>
{% endblock %}


{% block content %}

<section class="w-100 bg-white dark:bg-gray-900">
    <div class="mx-auto grid max-w-screen-xl px-4 pb-8 md:grid-cols-2 lg:gap-12 lg:pb-16 xl:gap-0 items-center">
        <!-- Left Column -->
        <div class="content-center justify-self-start md:col-span-1 md:text-start">
          <h1 class="mb-4 text-4xl font-extrabold leading-none tracking-tight dark:text-white md:max-w-2xl md:text-5xl xl:text-6xl">
            Limited Time Offer!<br />Up to 50% OFF!
          </h1>
          <p class="mb-4 max-w-2xl text-gray-500 dark:text-gray-400 md:mb-12 md:text-lg lg:mb-5 lg:text-xl">
            Don't Wait - Limited Stock at Unbeatable Prices!
          </p>
          <a href="#"
            class="inline-block rounded-lg bg-primary-700 px-6 py-3.5 text-center font-medium text-white hover:bg-primary-800 focus:outline-none focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
            {% translate "Enroll Now" %}
          </a>
        </div>
      
        <!-- Right Column -->
        <div class="md:col-span-1 md:mt-0 md:flex">
          <img class="dark:hidden" src="https://flowbite.s3.amazonaws.com/blocks/e-commerce/girl-shopping-list.svg" alt="shopping illustration" />
          <img class="hidden dark:block" src="https://flowbite.s3.amazonaws.com/blocks/e-commerce/girl-shopping-list-dark.svg" alt="shopping illustration" />
        </div>
    </div>
      
    <!-- carousel -->
    <div class="mx-auto max-w-screen-xl px-4">
        <div class="relative overflow-hidden">
            <!-- Scrollable Wrapper -->
            <div class="carousel-wrapper flex gap-8 text-gray-500 dark:text-gray-400 overflow-x-auto scroll-smooth">
                <!-- Card 1 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Harvard_University_logo.svg/220px-Harvard_University_logo.svg.png" /></div>
                <!-- Card 2 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://w7.pngwing.com/pngs/892/226/png-transparent-cornell-university-university-of-california-merced-university-of-central-florida-yale-university-others-text-label-trademark.png" />
                </div>
                <!-- Card 3 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRW4uMjwlikIuCcp5h0UW7Ba4lg5FLUnykcrg&s" />
                </div>
                <!-- Card 4 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://assets.campbell.edu/wp-content/uploads/sites/2/2024/04/Campbell_2024_Hrz_Orange_Screen.png" />
                </div>
                <!-- Card 5 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://www.kindpng.com/picc/m/148-1485905_university-logo-horizontal-arkansas-state-university-png-transparent.png" />
                </div>
                <!-- Card 6 -->
                <div class="flex-shrink-0 w-64 h-24 bg-gray-300 dark:bg-gray-600 rounded-lg">
                    <img class="rounded-lg object-cover h-full w-full" src="https://www.immaculata.edu/wp-content/uploads/2023/11/IU-Logo-Horizontal.png" />
                </div>
                <!-- Add more cards as needed -->
            </div>
        </div>
    </div>
  </section>

  <hr class="w-48 h-1 mx-auto my-4 bg-gray-100 border-0 rounded md:my-10 dark:bg-gray-700">
  
  <section class="w-100">
    <div class="max-w-screen-xl px-4 mx-auto lg:px-12 w-full">
      <div class="relative bg-white shadow-md dark:bg-gray-800 sm:rounded-lg">
        <div class="flex flex-col items-center justify-between p-4 space-y-3 md:flex-row md:space-y-0 md:space-x-4">
          <!-- Search -->
          <div class="w-full md:w-1/2">
            <form id="searchForm" class="flex items-center">
              <label for="simple-search" class="sr-only">Search</label>
              <div class="relative w-full">
                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                  <svg class="w-5 h-5 text-gray-500 dark:text-gray-400" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                  </svg>
                </div>
                <input
                  type="text"
                  id="searchInput"
                  name="search"
                  class="block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                  placeholder="Search"
                />
              </div>
            </form>
          </div>
          
        <div class="flex flex-col items-stretch justify-end flex-shrink-0 w-full space-y-2 md:w-auto md:flex-row md:space-y-0 md:items-center md:space-x-3">
          <button type="button" onclick="window.location.href='{% url 'schools:school_creation_form' %}';" class="flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg bg-blue-600 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300  focus:outline-none">
            <svg class="h-3.5 w-3.5 mr-2" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path clip-rule="evenodd" fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" />
            </svg>
            {% translate 'Add school'%}
          </button>

          <div class="flex items-center w-full space-x-3 md:w-auto">
          <!-- Sorting -->
            <button id="actionsDropdownButton" data-dropdown-toggle="actionsDropdown" class="flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg md:w-auto focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
              <svg class="-ml-1 mr-1.5 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 011.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>
              Sort
            </button>
            <div id="actionsDropdown" class="z-10 hidden bg-white divide-y divide-gray-100 rounded shadow w-44 dark:bg-gray-700 dark:divide-gray-600">
              <ul class="py-1 text-sm text-gray-700 dark:text-gray-200">
                <li>
                  <button class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Ascending</button>
                </li>
                <li>
                  <button class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600">Descending</button>
                </li>
              </ul>
              <div class="py-1">
                <button  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white">{% translate "Created Date" %}</button>
              </div>
            </div>
          
            <!-- Filters -->
            <button id="filterDropdownButton" data-dropdown-toggle="filterDropdown" class="flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg md:w-auto focus:outline-none hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <path d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" />
              </svg>
              Filter
            </button>
            <div id="filterDropdown" class="z-10 hidden w-48 p-3 bg-white rounded-lg shadow dark:bg-gray-700">
              <h6 class="mb-3 text-sm font-medium text-gray-900 dark:text-white">
                {% translate "Category" %}
              </h6>
              <form>
                <ul class="space-y-2 text-sm">
                  <li>
                    <input type="checkbox" name="type" value="1" class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                    <label for="apple" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100">
                      {% translate "University" %}
                    </label>
                  </li>
                  <li class="flex items-center">
                    <input type="checkbox" name="type" value="2" class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
                    <label for="type" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100">
                      {% translate "Community" %}
                    </label>
                  </li>
                </ul>
              </form>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Search Results -->
  <section class="bg-white dark:bg-gray-900 mt-4">
    <div class="py-8 px-2 mx-auto max-w-screen-xl text-center lg:py-12 lg:px-4">
      <div id="school-container" class="grid gap-8 lg:gap-12 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 ">

      </div>
    </div>
  </section>
  

{% endblock content %}
    

{% block scripts %}
<script type="text/javascript" src="{% static 'js/pages/schools-app.js' %}"></script>
{% comment %} <script type="text/javascript" src="{% static 'src/js/schools/index.js' %}"></script> {% endcomment %}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const schoolUrl = "{% url 'api:schools-view' %}";
    
    let searchBox = document.getElementById('searchInput');
    let container = document.querySelector('#school-container');

    console.log("URL", schoolUrl);

    // Handle search input
    searchBox.addEventListener("input", searchInputHandler);

    function searchInputHandler(e) {
        const query = e.target.value;
        fetchSchools(query);
    }
  
    // Function to fetch and display school data
    function fetchSchools(query = '') {
        fetch(schoolUrl, {
            method: 'GET',
            headers: { 'Content-Type': 'application/json' },
            mode: 'same-origin',
        })
            .then(response => {
                console.log("Response status:", response.status);
                return response.json();
            })
            .then(data => {
                displaySchools(data);
            })
            .catch(error => console.error("Error:", error));
    }

    // Function to display fetched school data
    function displaySchools(schools) {
        container.innerHTML = ''; // Clear previous content

        if (!Array.isArray(schools)) {
            console.error("Invalid response format. Expected an array.");
            container.innerHTML = '<p>Invalid data format received.</p>';
            return;
        }

        if (schools.length === 0) {
            container.innerHTML = '<p>No schools found.</p>';
            return;
        }

        schools.forEach(school => {
            // Create the card container
            const card = document.createElement('div');
            card.className = 'w-full bg-white border text-center border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700';
            card.setAttribute('id', 'card-container');

            // Create and append the anchor tag for image
            const aTag = document.createElement('a');
            aTag.href = "#";
            aTag.setAttribute('title', 'View school details');
            card.appendChild(aTag);

            // Create and append the card image
            const cardImage = document.createElement('img');
            cardImage.className = 'p-8 rounded-t-lg';
            cardImage.src = school.logo;
            cardImage.alt = `${school.name} logo`;
            aTag.appendChild(cardImage);

            // Create the card body
            const cardBody = document.createElement('div');
            cardBody.className = 'px-5 pb-5';
            cardBody.setAttribute('id', 'card-body');

            // Create the card title anchor
            const cardTitleAnchor = document.createElement('a');
            cardTitleAnchor.href = school.pk + '/';
            cardTitleAnchor.setAttribute('title', 'More details');

            // Create and append the card title
            const cardTitle = document.createElement('h5');
            cardTitle.className = 'lang-charset text-xl font-semibold tracking-tight text-gray-900 dark:text-white';
            cardTitle.textContent = school.name;

            cardTitleAnchor.appendChild(cardTitle);
            cardBody.appendChild(cardTitleAnchor);

            // Create the educational levels container
            const cardLevel = document.createElement('div');
            cardLevel.className = 'flex content-center items-center mt-2.5 mb-5';
            cardLevel.setAttribute('id', 'card-level');

            // Append educational levels (if available)
            if (Array.isArray(school.educational_levels) && school.educational_levels.length > 0) {
                school.educational_levels.forEach(level => {
                    const levelItem = document.createElement('div');
                    levelItem.className = 'flex items-center space-x-1 rtl:space-x-reverse text-sm text-gray-700 dark:text-gray-300';
                    levelItem.textContent = level.name;

                    cardLevel.appendChild(levelItem);
                });
            } else {
                const noLevel = document.createElement('p');
                noLevel.className = 'text-sm text-gray-500 dark:text-gray-400 text-center';
                noLevel.textContent = '';
                cardLevel.appendChild(noLevel);
            }

            cardBody.appendChild(cardLevel);
            card.appendChild(cardBody);
            container.appendChild(card);
        });
    }

    // Initial fetch to load all schools
    fetchSchools();
});


</script>
    
{% endblock scripts %}

<!-- Footer -->
{% block dock %}
    <button type="button" class="px-5 py-1.5 text-xs font-medium text-gray-900 hover:bg-gray-200 dark:text-white dark:hover:bg-gray-700 rounded-lg">
        News
    </button>
    <button type="button" class="px-5 py-1.5 text-xs font-medium text-white bg-gray-900 dark:bg-gray-300 dark:text-gray-900 rounded-lg">
        Public
    </button>
    <button type="button" class="px-5 py-1.5 text-xs font-medium text-gray-900 hover:bg-gray-200 dark:text-white dark:hover:bg-gray-700 rounded-lg">
        Community
    </button>
{% endblock dock %}